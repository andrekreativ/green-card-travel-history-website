<!DOCTYPE html>
<html>
<head>
	<title>Travel History</title>
</head>
<body>
	<h1>Travel History</h1>
	<form>
		<label for="destination">Destination:</label>
		<input type="text" id="destination" name="destination" placeholder="e.g. London, UK">

		<label for="startDate">Start Date:</label>
		<input type="date" id="startDate" name="startDate" onchange="autoPopulateEndDate()">

		<label for="endDate">End Date:</label>
		<input type="date" id="endDate" name="endDate">

		<button type="button" onclick="addTrip()">Add Trip</button>
	</form>

	<h2>Trip List</h2>
	<ul id="tripList"></ul>

	<button type="button" onclick="calculateTime()">Calculate Time Spent Abroad</button>

	<p id="result"></p>

	<script>
		var trips = [];

		function autoPopulateEndDate() {
			var startDateInput = document.getElementById("startDate").value;
			var endDateInput = new Date(startDateInput);
			endDateInput.setDate(endDateInput.getDate() + 1);
			var endDate = endDateInput.toISOString().slice(0,10);
			document.getElementById("endDate").value = endDate;
		}

		function addTrip() {
			var destinationInput = document.getElementById("destination").value;
			var startDateInput = document.getElementById("startDate").value;
			var endDateInput = document.getElementById("endDate").value;
			if (destinationInput !== "" && startDateInput !== "" && endDateInput !== "") {
				var tripInput = destinationInput + ", " + startDateInput + " - " + endDateInput;
				trips.push(tripInput);
				document.getElementById("tripList").innerHTML += "<li>" + tripInput + "</li>";
				document.getElementById("destination").value = "";
				document.getElementById("startDate").value = "";
				document.getElementById("endDate").value = "";
			}
		}

		function calculateTime() {
			// Calculate the total time spent abroad
			var totalTimeAbroad = 0;
			var today = new Date();
			for (var i = 0; i < trips.length; i++) {
				var tripDetails = trips[i].split(",");
				var destination = tripDetails[0];
				var startDate = new Date(tripDetails[1]);
				var endDate = new Date(tripDetails[2]);
				if (endDate.getTime() > today.getTime()) {
					endDate = today;
				}
				var timeDiff = endDate.getTime() - startDate.getTime();
				var daysAbroad = Math.ceil(timeDiff / (1000 * 3600 * 24));
				totalTimeAbroad += daysAbroad;
			}

			// Calculate the total time in the last 12 months
			var last12Months = new Date(today.getFullYear() - 1, today.getMonth(), today.getDate());
			var startDate = new Date(last12Months);
			var endDate = new Date(today);
			var timeDiff = endDate.getTime() - startDate.getTime();
			var daysLast12Months = Math.ceil(timeDiff / (1000 * 3600 * 24));

			// Display the result
			var percentAbroad = (totalTimeAbroad / daysLast12Months) * 100;
			document.getElementById("result").innerHTML = "You have spent " + totalTimeAbroad + " days abroad in the last 12 months, which is " + percentAbroad.toFixed(2) + "% of the time.";
		}
	</script>
</body>
</html>
